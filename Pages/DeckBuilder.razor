@page "/deck-builder"
@inject IJSRuntime JS

<div class="deck-root">
    <div id="pixelBgHost" class="pixel-bg-host" aria-hidden="true"></div>
    <h2 class="deck-title">DECK BUILDER</h2>
    <p class="deck-note">(Prototype) Configure a virtual control deck layout. Features coming soon.</p>
    <div class="deck-grid">
        <div class="deck-slot">A</div>
        <div class="deck-slot">B</div>
        <div class="deck-slot">START</div>
        <div class="deck-slot">SELECT</div>
        <div class="deck-slot">UP</div>
        <div class="deck-slot">DOWN</div>
        <div class="deck-slot">LEFT</div>
        <div class="deck-slot">RIGHT</div>
    </div>
    <div class="deck-footer">
    <a href="?skipHW=1" class="deck-link">RETURN</a>
    </div>
</div>

@code {
    protected override async Task OnInitializedAsync()
    {
        // Keep audio context alive when visiting deck builder
        try { await JS.InvokeVoidAsync("nesInterop.ensureAudioContext"); } catch { }
    // Ensure animated background is started (shared with Home)
    try { await JS.InvokeVoidAsync("eval", "window.homePixelBgEnsure && window.homePixelBgEnsure();"); } catch { }
    }
}
