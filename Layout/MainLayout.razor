@inherits LayoutComponentBase
@using BrokenNes.Layout
@using BrokenNes
@using BrokenNes.Shared
@using Microsoft.AspNetCore.Components.Web
<div class="app-shell">
    <header class="app-bar">
        <div class="brand" @onclick="NavigateHome" @onkeydown="OnBrandKey" role="button" tabindex="0" aria-label="Return to home">BrokenNes</div>
    </header>
    <div class="status-dock">
        <StatusBar />
    </div>
    <main class="app-main">
        @Body
    </main>
</div>

<!-- Persistent title music element (moved from Home.razor so early navigation during fade-in doesn't kill audio) -->
<audio id="titleMusic" src="music/TitleScreen.mp3" preload="auto" loop style="display:none"></audio>

@inject NavigationManager Nav

@code {
    private void NavigateHome()
    {
        // Use relative navigation (no leading slash) so subfolder hosting works (avoids resetting to domain root)
        Nav.NavigateTo("./?skipHW=1", forceLoad: false);
    }

    private void OnBrandKey(KeyboardEventArgs e)
    {
        if (e.Key == "Enter" || e.Key == " ")
        {
            NavigateHome();
        }
    }
}
